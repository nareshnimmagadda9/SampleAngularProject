<div class="container-fluid content-area">
    <section class="section">


        <div class="row page-titles m-b-0">
            <div class="col-md-5 align-self-center">
                <h3 class="text-themecolor">Bulk Uploads</h3>
            </div>
            <div class="col-md-7 align-self-center">
                <ol class="breadcrumb float-right">
                    <li class="breadcrumb-item"><a href="javascript:void(0)">Home</a></li>
                    <li class="breadcrumb-item active">Bulk Upload</li>
                </ol>
            </div>
        </div>

        <div class="card mb-2 clearfix">
            <div class="card-header">
                <div class="float-left">

                    <div class="container">
                        <div class="row">

                            <tabset>
                                <tab heading="Json Upload" id="tab1">
                                    <div class="panel">
                                        <form class="my-login-validation" [formGroup]="uploadform"
                                            (ngSubmit)="checkjsonupload()">


                                            <div class="form-group row">
                                                <label class="col-md-4 col-form-label" for="hf-email">BP ID</label>
                                                <div class="col-md-8 custom-dropdown">
                                                    <select name="" id="" class="form-control" formControlName="bpid">
                                                        <option value="" selected>Select Business Partner</option>
                                                        <option value="{{bp.BPID}}" *ngFor="let bp of assignedBP">
                                                            {{bp.BPID}}
                                                        </option>
                                                    </select>
                                                    <label for="" class="text-danger"
                                                        *ngIf="jsonsubmit && uploadform.controls.bpid.hasError('required')">
                                                        Please Select BP ID</label>
                                                </div>

                                            </div>

                                            <div class="form-group row">
                                                <label class="col-md-4 col-form-label" for="hf-email">Order
                                                    Header</label>
                                                <div class="col-md-8">

                                                    <input class="form-control" (change)="headerUpload($event)"
                                                        name="header" formControlName="Header" type="file"
                                                        placeholder="Select Header File">
                                                    <label for="" class="text-danger"
                                                        *ngIf="jsonsubmit && uploadform.controls.Header.hasError('required')">
                                                        Please Upload Order Header</label>
                                                    <label for="" class="text-danger"
                                                        *ngIf="jsonsubmit && uploadform.get('Header').hasError('err')">
                                                        Please Upload Json Format</label>

                                                </div>
                                            </div>

                                            <div class="form-group row">
                                                <label class="col-md-4 col-form-label" for="hf-email">Order Line</label>
                                                <div class="col-md-8">

                                                    <input class="form-control" (change)="lineUpload($event)"
                                                        name="lines" formControlName="Lines" type="file"
                                                        placeholder="Select Lines File">
                                                    <label for="" class="text-danger"
                                                        *ngIf="jsonsubmit && uploadform.controls.Lines.hasError('required')">
                                                        Please Upload Order Lines</label>
                                                    <label for="" class="text-danger"
                                                        *ngIf="jsonsubmit && uploadform.get('Lines').hasError('err')">
                                                        Please Upload Json Format</label>


                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label class="col-md-4 col-form-label" for="hf-salesoffice">Sales
                                                    Office</label>
                                                <div class="col-md-8 custom-dropdown" *ngIf="sofficelist">
                                                    <select class="form-control" id="select1" name="salesoffice"
                                                        formControlName="salesoffice">
                                                        <option value="" selected>--Select--</option>
                                                        <option value={{office.t_cwoc}}
                                                            *ngFor="let office of sofficelist"> {{office.t_dsca}}
                                                        </option>
                                                    </select>
                                                    <label for="" class="text-danger"
                                                        *ngIf="jsonsubmit && uploadform.controls.salesoffice.hasError('required')">
                                                        Please Select Sales Office</label>
                                                </div>

                                            </div>
                                            <div class="form-group row">
                                                <label class="col-md-4 col-form-label" for="hf-salesoffice">Sales
                                                    OrderType</label>
                                                <div class="col-md-8 custom-dropdown" *ngIf="sordertypelist">
                                                    <select class="form-control" id="select2" name="salesordertype"
                                                        formControlName="salesordertype">
                                                        <option value="" selected>--Select--</option>
                                                        <option value={{ordertype.t_sotp}}
                                                            *ngFor="let ordertype of sordertypelist">
                                                            {{ordertype.t_sotp}} </option>

                                                    </select>
                                                    <label for="" class="text-danger"
                                                        *ngIf="jsonsubmit && uploadform.controls.salesordertype.hasError('required')">
                                                        Please Select SalesOrderType</label>
                                                </div>

                                            </div>

                                            <div class="form-group row">
                                                <label class="col-md-4 col-form-label" for="hf-salesoffice">Master
                                                    Series</label>
                                                <div class="col-md-8 custom-dropdown" *ngIf="masterserieslist">
                                                    <select class="form-control" id="select3" name="masterseries"
                                                        formControlName="masterseries">
                                                        <option value="" selected>--Select--</option>
                                                        <option value={{series.t_seri}}
                                                            *ngFor="let series of masterserieslist">{{series.t_seri}}
                                                        </option>
                                                    </select>
                                                    <label for="" class="text-danger"
                                                        *ngIf="jsonsubmit && uploadform.controls.masterseries.hasError('required')">
                                                        Please Select Master Series</label>
                                                </div>


                                            </div>



                                            <div class="form-group m-0">
                                                <button type="submit" class="btn btn-lg btn-primary" id="upload">
                                                    Upload
                                                </button>
                                            </div>


                                        </form>
                                    </div>
                                </tab>
                                <tab heading="Excel Upload">
                                    <div class="panel">
                                        <form class="my-login-validation" [formGroup]="uploadordersexcel"
                                            (ngSubmit)="checkexcelupload()">


                                            <div class="form-group row">
                                                <label class="col-md-4 col-form-label" for="hf-email">BP ID</label>
                                                <div class="col-md-8 custom-dropdown">
                                                    <select name="" id="" class="form-control" formControlName="bpid">
                                                        <option value="" selected>Select Business Partner</option>
                                                        <option value="{{bp.BPID}}" *ngFor="let bp of assignedBP">
                                                            {{bp.BPID}}
                                                        </option>
                                                    </select>
                                                    <label for="" class="text-danger"
                                                        *ngIf="excelsubmit && uploadordersexcel.controls.bpid.hasError('required')">
                                                        Please Select BP ID</label>
                                                </div>

                                            </div>

                                            <div class="form-group row">
                                                <label class="col-md-4 col-form-label" for="hf-email">Order
                                                    Header</label>
                                                <div class="col-md-8">

                                                    <input class="form-control" (change)="excelUpload($event)"
                                                        name="header" formControlName="Header" type="file"
                                                        placeholder="Select Header File">
                                                    <label for="" class="text-danger"
                                                        *ngIf="excelsubmit && uploadordersexcel.controls.Header.hasError('required')">
                                                        Please Upload Order Header</label>
                                                    <label for="" class="text-danger"
                                                        *ngIf="excelsubmit && uploadordersexcel.get('Header').hasError('err')">
                                                        Please Upload Excel Format</label>

                                                </div>
                                            </div>

                                            <div class="form-group row">
                                                <label class="col-md-4 col-form-label" for="hf-salesoffice">Sales
                                                    Office</label>
                                                <div class="col-md-8 custom-dropdown" *ngIf="sofficelist">
                                                    <select class="form-control" id="select1" name="salesoffice"
                                                        formControlName="salesoffice">
                                                        <option value="" selected>--Select--</option>
                                                        <option value={{office.t_cwoc}}
                                                            *ngFor="let office of sofficelist"> {{office.t_dsca}}
                                                        </option>
                                                    </select>
                                                    <label for="" class="text-danger"
                                                        *ngIf="excelsubmit && uploadordersexcel.controls.salesoffice.hasError('required')">
                                                        Please Select Sales Office</label>
                                                </div>

                                            </div>
                                            <div class="form-group row">
                                                <label class="col-md-4 col-form-label" for="hf-salesoffice">Sales
                                                    OrderType</label>
                                                <div class="col-md-8 custom-dropdown" *ngIf="sordertypelist">
                                                    <select class="form-control" id="select2" name="salesordertype"
                                                        formControlName="salesordertype">
                                                        <option value="" selected>--Select--</option>
                                                        <option value={{ordertype.t_sotp}}
                                                            *ngFor="let ordertype of sordertypelist">
                                                            {{ordertype.t_sotp}} </option>

                                                    </select>
                                                    <label for="" class="text-danger"
                                                        *ngIf="excelsubmit && uploadordersexcel.controls.salesordertype.hasError('required')">
                                                        Please Select SalesOrderType</label>
                                                </div>

                                            </div>

                                            <div class="form-group row">
                                                <label class="col-md-4 col-form-label" for="hf-salesoffice">Master
                                                    Series</label>
                                                <div class="col-md-8 custom-dropdown" *ngIf="masterserieslist">
                                                    <select class="form-control" id="select3" name="masterseries"
                                                        formControlName="masterseries">
                                                        <option value="" selected>--Select--</option>
                                                        <option value={{series.t_seri}}
                                                            *ngFor="let series of masterserieslist">{{series.t_seri}}
                                                        </option>
                                                    </select>
                                                    <label for="" class="text-danger"
                                                        *ngIf="excelsubmit && uploadordersexcel.controls.masterseries.hasError('required')">
                                                        Please Select Master Series</label>
                                                </div>


                                            </div>



                                            <div class="form-group m-0">
                                                <button type="submit" class="btn btn-lg btn-primary" id="upload">
                                                    Upload
                                                </button>
                                            </div>


                                        </form>
                                    </div>
                                </tab>
                            </tabset>



                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>



<div class="loading" *ngIf="loading"></div>